<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudo Social v4</title>
    <style>
        :root { 
            --preto: #0e1117; --branco: #ffffff; --azul: #1DA1F2; --ouro: #ffd700; 
            --chat-bg: #151921; /* Cor para descanso visual */
            --msg-in: #ffffff; --msg-out: #dcf8c6;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--preto); color: var(--branco); margin: 0; padding: 0; overflow-x: hidden; }

        /* HEADER E UI */
        header { padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        .dots-btn { font-size: 18px; cursor: pointer; padding: 5px; }

        /* JANELA CHAT COM AURA PREMIUM */
        .win-chat { 
            display: none; position: fixed; top: 10%; left: 5%; right: 5%; height: 75vh; 
            background: var(--chat-bg); border-radius: 15px; flex-direction: column; z-index: 2000;
            box-shadow: 0 0 20px rgba(0,0,0,0.5); overflow: hidden;
        }
        .premium-aura { border: 2px solid var(--ouro); box-shadow: 0 0 15px var(--ouro), inset 0 0 10px rgba(255,215,0,0.3); }

        /* CHAT */
        .chat-messages { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 8px; background: var(--chat-bg); }
        .msg-bubble { padding: 8px 12px; border-radius: 12px; color: #000; max-width: 80%; font-size: 14px; position: relative; }
        .msg-sys { background: rgba(0,0,0,0.3); color: var(--ouro); font-size: 11px; text-align: center; border-radius: 5px; padding: 5px; width: 90%; align-self: center; }

        /* CALCULADORA COMPACTA */
        .calc-box { 
            display: none; position: fixed; top: 20%; left: 15%; width: 70%; 
            background: #1a1a1a; border: 1px solid #444; border-radius: 10px; padding: 10px; z-index: 3000;
        }
        .calc-screen { width: 92%; background: #000; color: #0f0; text-align: right; padding: 10px; margin-bottom: 5px; font-family: monospace; }
        .calc-btns { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .calc-btns button { padding: 10px; border: none; border-radius: 5px; background: #333; color: white; }

        /* PERFIL */
        .pfp-small { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--preto); }
        .crown-small { position: absolute; top: -15px; left: 25px; font-size: 25px; display: none; }

        /* INPUT AREA */
        .footer-input { background: #1c2128; padding: 10px; display: flex; align-items: center; gap: 8px; }
        .in-txt { flex: 1; background: #0d1117; border: 1px solid #30363d; color: white; padding: 10px; border-radius: 20px; }

        .fire-name { color: var(--ouro); font-weight: bold; text-shadow: 0 0 5px orange; }
    </style>
</head>
<body>

    <header>
        <div>
            <strong style="color: var(--azul);">Estudo Social</strong><br>
            <small id="meu-id">ID: 22</small>
        </div>
        <div class="dots-btn" onclick="openWin('win-profile')">‚ãÆ</div>
    </header>

    <div style="padding: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <div onclick="alert('Playlist: Matem√°tica')" style="background:#161b22; padding:20px; border-radius:10px; text-align:center;">Matem√°tica</div>
        <div onclick="openWin('win-create-group')" style="background:var(--azul); padding:20px; border-radius:10px; text-align:center;">+ Criar Grupo</div>
    </div>

    <div id="win-profile" class="win-chat" style="display: none; background: #0d1117; color: white;">
        <div style="padding: 15px; display: flex; justify-content: space-between; border-bottom: 1px solid #333;">
            <span>Configura√ß√µes</span>
            <button onclick="closeWin('win-profile')">‚úï</button>
        </div>
        <div style="padding: 20px; overflow-y: auto;">
            <div style="position: relative; width: 80px;">
                <span id="u-crown" class="crown-small">üëë</span>
                <img id="u-pfp" src="https://via.placeholder.com/80" class="pfp-small" onclick="document.getElementById('in-pfp').click()">
            </div>
            <div style="margin-top: 10px;">
                <label>Seu @:</label><br>
                <input type="text" id="u-at" value="@Dono_22" style="background:#000; color:white; border:1px solid #444; width:90%;"><br><br>
                <label>Sua Bio:</label><br>
                <textarea id="u-bio" style="background:#000; color:white; border:1px solid #444; width:90%;">Dono do Site</textarea>
                <p><strong>Meu ID: 22</strong></p>
            </div>
            <hr>
            <button onclick="loginGoogle()" style="width: 100%; padding: 10px; background: white; color: black; border-radius: 5px;">Entrar com Google G</button><br><br>
            <button onclick="buyPremium()" style="width: 100%; padding: 10px; background: var(--ouro); color: black; border-radius: 5px;">Comprar Premium üëë</button>
            <br><br>
            <button onclick="toggleCalc()">Calculadora Compacta</button>
        </div>
    </div>

    <div id="win-chat" class="win-chat">
        <div style="background: #1c2128; padding: 12px; display: flex; justify-content: space-between; align-items: center; color: white;">
            <div onclick="openWin('win-group-manage')">
                <strong id="g-display-name">Grupo #27</strong><br>
                <small id="typing-status" style="color:var(--azul); font-size:10px;"></small>
            </div>
            <button onclick="closeWin('win-chat')">‚úï</button>
        </div>
        <div class="chat-messages" id="chat-box">
            <div class="msg-sys">Mem√≥ria Ativada: Novos membros ver√£o o hist√≥rico completo.</div>
        </div>
        <div class="footer-input">
            <button onclick="document.getElementById('in-chat-file').click()" style="background:none; border:none; font-size:20px;">üñºÔ∏è</button>
            <button id="btn-audio" onclick="toggleAudio()" style="background:none; border:none; font-size:20px;">üé§</button>
            <input type="text" id="chat-in" class="in-txt" placeholder="Mensagem..." oninput="isTyping()">
            <button onclick="sendMsg()" style="background:none; border:none; color:var(--azul); font-size:22px;">‚û°Ô∏è</button>
        </div>
    </div>

    <div id="calc-win" class="calc-box">
        <input type="text" id="calc-screen" class="calc-screen" readonly>
        <div class="calc-btns">
            <button onclick="cVal('7')">7</button><button onclick="cVal('8')">8</button><button onclick="cVal('9')">9</button><button onclick="cVal('/')">/</button>
            <button onclick="cVal('4')">4</button><button onclick="cVal('5')">5</button><button onclick="cVal('6')">6</button><button onclick="cVal('*')">*</button>
            <button onclick="cVal('1')">1</button><button onclick="cVal('2')">2</button><button onclick="cVal('3')">3</button><button onclick="cVal('-')">-</button>
            <button onclick="cVal('0')">0</button><button onclick="cVal('C')">C</button><button onclick="cRes()">=</button><button onclick="cVal('+')">+</button>
        </div>
        <button onclick="toggleCalc()" style="width:100%; margin-top:5px; font-size:10px;">Fechar</button>
    </div>

    <div id="win-group-manage" class="win-chat" style="display:none; background:#fff; color:#000;">
        <div style="padding:15px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between;">
            <strong>Gest√£o do Grupo</strong>
            <button onclick="closeWin('win-group-manage')">‚úï</button>
        </div>
        <div style="padding:15px;">
            <p>Membros: 1/5000</p>
            <button onclick="toggleLock('somente-adm')">Apenas ADMs podem falar</button><br><br>
            <button onclick="toggleLock('trancado')">Trancar Grupo</button><br><br>
            <button onclick="alert('Membro Adicionado pelo ID!')">Adicionar por ID</button>
        </div>
    </div>

    <input type="file" id="in-pfp" hidden onchange="readImg(this, 'u-pfp')">
    <input type="file" id="in-chat-file" hidden onchange="sendImg(this)">

    <div onclick="openWin('win-chat')" style="position:fixed; bottom:20px; right:20px; font-size:40px;">üìñ</div>

    <script>
        let isPremium = false;
        let isRecording = false;
        let msgs = []; // Simula√ß√£o de mensagens salvas
        let typingTimer;

        function openWin(id) { document.getElementById(id).style.display = 'flex'; }
        function closeWin(id) { document.getElementById(id).style.display = 'none'; }
        function toggleCalc() { 
            let c = document.getElementById('calc-win');
            c.style.display = c.style.display === 'block' ? 'none' : 'block';
        }

        function buyPremium() {
            isPremium = true;
            document.getElementById('u-crown').style.display = 'block';
            document.getElementById('win-chat').classList.add('premium-aura');
            alert("Premium Ativado! Aura amarela e Coroa liberadas.");
        }

        function loginGoogle() { alert("Conectando √† conta Google..."); }

        function sendMsg() {
            let input = document.getElementById('chat-in');
            if(!input.value) return;
            let box = document.getElementById('chat-box');
            let nameClass = isPremium ? 'fire-name' : '';
            
            let html = `
                <div style="align-self: flex-end; display:flex; flex-direction:column; align-items:flex-end;">
                    <div class="msg-bubble" style="background:var(--msg-out)">
                        <small class="${nameClass}">Criador #27</small><br>${input.value}
                    </div>
                </div>`;
            box.innerHTML += html;
            input.value = "";
            box.scrollTop = box.scrollHeight;
        }

        function sendImg(input) {
            if (input.files && input.files[0]) {
                let r = new FileReader();
                r.onload = e => {
                    document.getElementById('chat-box').innerHTML += `
                        <div style="align-self: flex-end;">
                            <img src="${e.target.result}" style="max-width:200px; border-radius:10px;">
                        </div>`;
                };
                r.readAsDataURL(input.files[0]);
            }
        }

        function toggleAudio() {
            let btn = document.getElementById('btn-audio');
            let status = document.getElementById('typing-status');
            if(!isRecording) {
                isRecording = true;
                btn.style.color = "red";
                status.innerText = "Dono est√° gravando √°udio...";
            } else {
                isRecording = false;
                btn.style.color = "white";
                status.innerText = "";
                document.getElementById('chat-box').innerHTML += `<div style="align-self:flex-end;"><div class="msg-bubble" style="background:#dcf8c6">üéµ √Åudio HD Enviado</div></div>`;
            }
        }

        function isTyping() {
            document.getElementById('typing-status').innerText = "Dono est√° escrevendo...";
            clearTimeout(typingTimer);
            typingTimer = setTimeout(() => document.getElementById('typing-status').innerText = "", 1500);
        }

        function toggleLock(tipo) {
            let box = document.getElementById('chat-box');
            if(tipo === 'somente-adm') {
                box.innerHTML += `<div class="msg-sys">Adm @Dono_22 alterou as configura√ß√µes do grupo para somente adms podem mandar mensagem.</div>`;
            } else {
                box.innerHTML += `<div class="msg-sys">O grupo est√° trancado, somente os adm podem remover essa fun√ß√£o.</div>`;
            }
        }

        function readImg(i, id) {
            if (i.files && i.files[0]) {
                let r = new FileReader();
                r.onload = e => document.getElementById(id).src = e.target.result;
                r.readAsDataURL(i.files[0]);
            }
        }

        // Calculadora L√≥gica
        function cVal(v) { let s = document.getElementById('calc-screen'); if(v==='C') s.value=""; else s.value+=v; }
        function cRes() { try { let s = document.getElementById('calc-screen'); s.value = eval(s.value); } catch { alert("Erro"); } }
    </script>
</body>
</html>
